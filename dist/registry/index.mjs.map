{"version":3,"sources":["../../src/registry/index.ts"],"names":[],"mappings":";AAIA,IAAM,aAAgD,EAAC;AAGvD,IAAM,eAA4C,EAAC;AAQ5C,SAAS,aAAA,CACd,OAAA,EACA,UAAA,EACA,MAAA,EACM;AACN,EAAA,UAAA,CAAW,OAAO,IAAI,EAAE,GAAG,WAAW,OAAO,CAAA,EAAG,GAAG,UAAA,EAAW;AAE9D,EAAA,IAAI,MAAA,EAAQ;AACV,IAAA,YAAA,CAAa,OAAO,CAAA,GAAI,EAAE,EAAA,EAAI,OAAA,EAAS,GAAG,MAAA,EAAO;AAAA,EACnD;AACF;AAQO,SAAS,iBAAA,CACd,OAAA,EACA,aAAA,EACA,SAAA,EACM;AACN,EAAA,IAAI,CAAC,UAAA,CAAW,OAAO,CAAA,EAAG;AACxB,IAAA,UAAA,CAAW,OAAO,IAAI,EAAC;AAAA,EACzB;AACA,EAAA,UAAA,CAAW,OAAO,CAAA,CAAE,aAAa,CAAA,GAAI,SAAA;AACvC;AAQO,SAAS,gBAAA,CACd,SACA,aAAA,EACyB;AAEzB,EAAA,MAAM,cAAA,GAAiB,UAAA,CAAW,OAAO,CAAA,GAAI,aAAa,CAAA;AAC1D,EAAA,IAAI,cAAA,EAAgB;AAClB,IAAA,OAAO,cAAA;AAAA,EACT;AAGA,EAAA,MAAM,gBAAA,GAAmB,UAAA,CAAW,SAAS,CAAA,GAAI,aAAa,CAAA;AAC9D,EAAA,IAAI,gBAAA,EAAkB;AACpB,IAAA,OAAO,gBAAA;AAAA,EACT;AAGA,EAAA,OAAO,IAAA;AACT;AAOO,SAAS,kBAAA,CAAmB,SAAiB,aAAA,EAAgC;AAClF,EAAA,OAAO,CAAC,CAAC,UAAA,CAAW,OAAO,IAAI,aAAa,CAAA;AAC9C;AAMO,SAAS,wBAAwB,OAAA,EAA2B;AACjE,EAAA,OAAO,OAAO,IAAA,CAAK,UAAA,CAAW,OAAO,CAAA,IAAK,EAAE,CAAA;AAC9C;AAKO,SAAS,mBAAA,GAAgC;AAC9C,EAAA,OAAO,MAAA,CAAO,KAAK,UAAU,CAAA;AAC/B;AAMO,SAAS,eAAe,OAAA,EAAqC;AAClE,EAAA,OAAO,YAAA,CAAa,OAAO,CAAA,IAAK,IAAA;AAClC;AAKO,SAAS,aAAA,GAAsB;AACpC,EAAA,MAAA,CAAO,IAAA,CAAK,UAAU,CAAA,CAAE,OAAA,CAAQ,CAAC,GAAA,KAAQ,OAAO,UAAA,CAAW,GAAG,CAAC,CAAA;AAC/D,EAAA,MAAA,CAAO,IAAA,CAAK,YAAY,CAAA,CAAE,OAAA,CAAQ,CAAC,GAAA,KAAQ,OAAO,YAAA,CAAa,GAAG,CAAC,CAAA;AACrE","file":"index.mjs","sourcesContent":["import type { ComponentType } from 'react';\r\nimport type { ComponentRegistry, ThemeConfig } from '../types';\r\n\r\n// 存储所有主题的组件注册表\r\nconst registries: Record<string, ComponentRegistry> = {};\r\n\r\n// 存储主题配置\r\nconst themeConfigs: Record<string, ThemeConfig> = {};\r\n\r\n/**\r\n * 注册主题组件\r\n * @param themeId 主题 ID (如 'bsd', 'artist', 'concept')\r\n * @param components 组件注册表\r\n * @param config 主题配置（可选）\r\n */\r\nexport function registerTheme(\r\n  themeId: string,\r\n  components: ComponentRegistry,\r\n  config?: Omit<ThemeConfig, 'id'>\r\n): void {\r\n  registries[themeId] = { ...registries[themeId], ...components };\r\n\r\n  if (config) {\r\n    themeConfigs[themeId] = { id: themeId, ...config };\r\n  }\r\n}\r\n\r\n/**\r\n * 注册单个组件到指定主题\r\n * @param themeId 主题 ID\r\n * @param componentName 组件名称\r\n * @param component 组件\r\n */\r\nexport function registerComponent(\r\n  themeId: string,\r\n  componentName: string,\r\n  component: ComponentType<any>\r\n): void {\r\n  if (!registries[themeId]) {\r\n    registries[themeId] = {};\r\n  }\r\n  registries[themeId][componentName] = component;\r\n}\r\n\r\n/**\r\n * 解析组件 - 优先使用主题特定组件，fallback 到 default\r\n * @param themeId 主题 ID\r\n * @param componentName 组件名称\r\n * @returns 组件或 null\r\n */\r\nexport function resolveComponent<P = any>(\r\n  themeId: string,\r\n  componentName: string\r\n): ComponentType<P> | null {\r\n  // 1. 先尝试获取主题特定组件\r\n  const themeComponent = registries[themeId]?.[componentName];\r\n  if (themeComponent) {\r\n    return themeComponent as ComponentType<P>;\r\n  }\r\n\r\n  // 2. Fallback 到 default 主题\r\n  const defaultComponent = registries['default']?.[componentName];\r\n  if (defaultComponent) {\r\n    return defaultComponent as ComponentType<P>;\r\n  }\r\n\r\n  // 3. 未找到\r\n  return null;\r\n}\r\n\r\n/**\r\n * 检查主题是否有特定组件的定制版本\r\n * @param themeId 主题 ID\r\n * @param componentName 组件名称\r\n */\r\nexport function hasCustomComponent(themeId: string, componentName: string): boolean {\r\n  return !!registries[themeId]?.[componentName];\r\n}\r\n\r\n/**\r\n * 获取主题的所有已注册组件名称\r\n * @param themeId 主题 ID\r\n */\r\nexport function getRegisteredComponents(themeId: string): string[] {\r\n  return Object.keys(registries[themeId] || {});\r\n}\r\n\r\n/**\r\n * 获取所有已注册的主题 ID\r\n */\r\nexport function getRegisteredThemes(): string[] {\r\n  return Object.keys(registries);\r\n}\r\n\r\n/**\r\n * 获取主题配置\r\n * @param themeId 主题 ID\r\n */\r\nexport function getThemeConfig(themeId: string): ThemeConfig | null {\r\n  return themeConfigs[themeId] || null;\r\n}\r\n\r\n/**\r\n * 清除所有注册（主要用于测试）\r\n */\r\nexport function clearRegistry(): void {\r\n  Object.keys(registries).forEach((key) => delete registries[key]);\r\n  Object.keys(themeConfigs).forEach((key) => delete themeConfigs[key]);\r\n}\r\n"]}